\section{Creating the Message Protocol}
When implementing the communication between the physical robots and the server software, the groups realised the need for a general message protocol. The message protocol should be complex enough to consist of different message types and parameters as well as being simple enough to be easy to understand and implement in software. 

The groups sat down and discussed what kinds of messages the protocol should implement, and what the message types should include of parameters. The message types and parameters were listed as shown in Table \ref{tab:messprotfromrob} and Table \ref{tab:messprotfromser}:

\begin{table}[ht]
\begin{center}
 \begin{tabular}{|l | l|} 
 \hline
 Message type       &    Parameters \\
 \hline
 \hline
 From Robot: & \\
 \hline
 Handshake          &   Message type \\
                     &    Physical robot width and length  \\
                    &   Tower offset from centreof the robot\\
                    &    Axle offset lengthwise \\
                    &    Sensor offset from tower center \\
                    &    Initial sensor heading \\
 \hline
 Update              &   Message type \\
                    &   Robot position (x,y) \\
                    &   Orientation \\
                    &   Tower heading \\
                    &    Sensor values \\
 \hline
 Status                &   Message type \\
                     &    Idle\\
 \hline
 \end{tabular}
\end{center}
\caption{Sketched list over messages from the Robot}
\label{tab:messprotfromrob}
\end{table}

\begin{table}[ht]
\begin{center}
 \begin{tabular}{|l | l|} 
 \hline
 Message type       &    Parameters \\
 \hline
 \hline
 From Server: & \\
 \hline
 Update              &   Message type \\
                    &   Orientation \\
                    &   Distance \\
 \hline
 Status                &   Hanshake confirmed \\
                    &   Pause robot \\
                    &   Unpause robot \\
                    &   Robot finished \\
 \hline
\end{tabular}
\end{center}
\caption{Sketched list over messages from the Server}
\label{tab:messprotfromser}
\end{table}

At first, the group developed a message protocol using JSON-structure. The benefit of using JSON to structure a message protocol is that it is easy to understand just by reading the message as well as the order of the parameters does not have to be specified. The update message from server in JSON-structure was defined as:

\{``Update'':[\{``Orientation'':``60''\},\{``Distance'':``100''\}]\}
\task{Skrive disse på kodesnutt-måte?}

Due to some problems with the nRF51-server software not being able to receive messages with a size greater than 60 Bytes, and the nrf51-peripheral not being able to receive messages greater than 20 Bytes, the group converted the message protocol from JSON-structure to a more compact designed structure. The update message (from server) was then defined as:

\{U,60,100\}

The remaining message types were defined in the same manner. Figure \ref{fig:messprot}, and Appendix BLABLA, presents all message types and parameters implemented in the message protocol. As can be seen, some of the message content is adjusted from what was originally planned in Table \ref{tab:messprotfromrob} and \ref{tab:messprotfromser}. \task{appendixxxx}

\mabox{1}{Results/Meldingsprotokoll}{Message Protocol}{fig:messprot}